clc;
close all;
close;

v_oc = 24.48;
i_sc = 1.20;

% v = [22.77, 22.62, 22.44, 22.22, 21.99, 21.84, 21.48, 21.03, 20.47, 19.78, 19.22, 18.21, 17.07, 15.81, 14.56, 13.55, 12.86];
% i = [0.603, 0.662, 0.715, 0.768, 0.813, 0.852, 0.910, 0.968, 1.028, 1.085, 1.117, 1.149, 1.165, 1.169, 1.173, 1.175, 1.174];

v = [22.77, 22.62, 22.44, 22.22, 21.99, 21.84, 21.48, 21.03, 20.47, 19.78, 19.22, 18.21, 19.21, 19.56, 19.31, 18.48, 19.14, 19.76, 19.04, 18.65, 19.27, 19.86, 19.41, 18.36, 19.28];
i = [0.603, 0.662, 0.715, 0.768, 0.813, 0.852, 0.910, 0.968, 1.028, 1.085, 1.117, 1.149, 1.130, 1.067, 1.128, 1.136, 1.130, 1.048, 1.135, 1.138, 1.136, 1.048, 1.129, 1.141, 1.139];

p = v .* i;

% FFt
p_fft = fft(p);

% Welch's Power Spectrum Density 
[p_psd,p_psd_f] = pwelch(p);

% Total Harmonic Distortion
r = thd(p,50,2);
disp(r);

figure;
subplot(4, 1, 1);
plot(p_fft);
grid on;

subplot(4, 1, 2);
stem(abs(p_fft));
grid on;

subplot(4, 1, 3);
stem(p_psd_f, p_psd);
grid on;

subplot(4, 1, 4);
stem(r);
grid on;